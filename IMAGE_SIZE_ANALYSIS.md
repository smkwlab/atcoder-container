# AtCoder Container イメージサイズ分析

## 概要

AtCoder コンテナの各バージョンにおける言語・コンポーネント別のファイルサイズ分析結果です。

## イメージ一覧

| イメージ名 | タグ | サイズ | 説明 |
|------------|------|--------|------|
| `ghcr.io/smkwlab/atcoder-container` | latest | 3.18GB | 旧バージョン（asdf管理） |
| `atcoder-lite` | 2025 | 5.45GB | 新ライト版（必須ライブラリのみ） |
| `atcoder-full` | 2025 | 8.03GB | 新フル版（機械学習ライブラリ含む） |

## 言語・コンポーネント別サイズ比較

| コンポーネント | 旧バージョン<br>(3.18GB) | ライト版<br>(5.45GB) | フル版<br>(8.03GB) | 差分<br>(フル-ライト) |
|----------------|-------------|------------|------------|------------|
| **Python** | 331MB | 792MB | 1.53GB | +738MB |
| **Node.js** | 206MB | 224MB | 224MB | 0MB |
| **Ruby** | 112MB | 895MB | 931MB | +36MB |
| **Java** | 318MB | 136MB | 136MB | 0MB |
| **Erlang** | 142MB | 163MB | 163MB | 0MB |
| **Elixir** | 13MB | (含む) | (含む) | 0MB |
| **Rust** | 1.5GB | ❌ なし | ❌ なし | 0MB |
| **LibTorch** | ❌ なし | ❌ なし | ~454MB | +454MB |
| **PyTorch (Python)** | ❌ なし | ❌ なし | ~442MB | +442MB |
| **システム(/usr)** | 576MB | 3.0GB | 4.4GB | +1.4GB |

## 詳細分析

### Python の変化（331MB → 1.53GB）
- **最適化ビルド**: LTO（Link Time Optimization）、BOLT 有効化
- **科学計算ライブラリ**: NumPy 2.2.6、SciPy 1.15.3、pandas 2.3.0 等
- **フル版追加**: PyTorch 2.6.0+cpu（+738MB）

### Ruby の変化（112MB → 895MB）
- **GCパッチ適用**: 性能向上のためのパッチ
- **gem ライブラリ**: 競技プログラミング用 + 科学計算系
- **フル版追加**: torch-rb 0.20.0（+36MB）

### Rust の除外（-1.5GB）
- 新バージョンでは Rust 1.70.0 を除外
- サイズ削減の主要要因

### 機械学習ライブラリ（フル版のみ +896MB）
- **LibTorch**: 454MB（C++ 機械学習ライブラリ）
- **PyTorch**: 442MB（Python 機械学習フレームワーク）

## 言語バージョン比較

### 旧バージョン
- Python: 古いバージョン（asdf管理）
- Node.js: 古いバージョン（asdf管理）
- Ruby: 古いバージョン（asdf管理）
- Java: 古いバージョン（asdf管理）
- Erlang: 古いバージョン（asdf管理）
- Elixir: 古いバージョン（asdf管理）
- Rust: 1.70.0

### 新バージョン（ライト版・フル版共通）
- **Python**: 3.13.5（LTO/BOLT最適化）
- **Node.js**: 22.16.0
- **Ruby**: 3.4.4（GCパッチ適用）
- **Java**: JDK 23.0.1
- **Erlang**: 28.0
- **Elixir**: 1.18.4
- **Rust**: ❌ 除外

## 推奨使用方法

### ライト版（5.45GB）推奨ケース
- 一般的な競技プログラミング
- アルゴリズム問題
- データ構造問題
- 数学的計算問題

### フル版（8.03GB）推奨ケース
- 機械学習を使用する問題
- 深層学習が必要な問題
- 大規模数値計算
- PyTorch/LibTorch が必要な場合

## サイズ増加要因まとめ

| 要因 | 影響度 | 説明 |
|------|--------|------|
| **Python最適化ビルド** | +1.2GB | LTO、BOLT、科学計算ライブラリ |
| **Ruby拡張** | +783MB | GCパッチ、競技プログラミング用gem |
| **Rust除外** | -1.5GB | サイズ削減効果 |
| **機械学習ライブラリ** | +896MB | PyTorch、LibTorch（フル版のみ） |
| **システム基盤** | +2.4GB | Ubuntu、ビルドツール、その他 |

## 結論

- **旧バージョン**: 軽量だが言語バージョンが古い
- **ライト版**: 現代的な言語バージョンで適度なサイズ
- **フル版**: 機械学習対応で包括的だが大容量

競技プログラミングの用途に応じて適切なバージョンを選択することを推奨します。